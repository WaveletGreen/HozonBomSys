<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:include="include/includebase"></head>
<link th:href="@{/css/stage/bom-stage.css}" rel="stylesheet"/>
<meta charset="UTF-8">
    <title></title>
</head>
<body>
    <div>
        <p><strong>温馨提醒:这里限制上传文件大小的最大值为10MB</strong></p>
    </div>
    <div class="form-group" id="thumbnailUploadContainer" class="col-sm-10" style="float: left; margin-right: 50px;">
        <input id="articleImageFile" name="excelFile" type="file" class="form-control" style="width: 300px; display: inline;" />
        <input id="saveZipButton" type="button" style="width: 60px;height: 35px;" value="上传" />
    </div>
    <script type="text/javascript">
        //导入excel文件
        $("#saveZipButton").on('click', function(){
            var formData = new FormData();
            var name = $("#articleImageFile").val();
            var projectId = $("#project", window.top.document).val();
            formData.append("file",$("#articleImageFile")[0].files[0]);
            formData.append("name",name);
            formData.append("projectId",projectId);
            if(name==null || name == ''){
                window.Ewin.alert({message: '请选择要上传的文件~'});
                return;
            }
            $.ajax({
                url :"/hozon/file/upload",
                type : 'POST',
                async : false,
                data : formData,
                // 告诉jQuery不要去处理发送的数据
                processData : false,
                // 告诉jQuery不要去设置Content-Type请求头
                contentType : false,
                // beforeSend:function(){
                //     window.Ewin.alert({message: '系统正在处理，请耐心等待...'});
                // },
                success : function(result) {
                    if (result.success) {
                        layer.msg(result.errMsg, {icon: 1, time: 2000})
                    }
                    else if (!result.success && result.errMsg.length>15) {
                        var msg = "<div style='height: 50%;overflow: auto'>"+ result.errMsg+"</div>"
                        window.Ewin.confirm({title:'提示',message: msg})
                    }else {
                        window.Ewin.alert({message: result.errMsg})
                    }
                }
            });
        });

    </script>
</body>
</html>