package com.connor.hozon;import org.apache.catalina.Context;import org.apache.catalina.connector.Connector;import org.apache.tomcat.util.descriptor.web.SecurityCollection;import org.apache.tomcat.util.descriptor.web.SecurityConstraint;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.boot.builder.SpringApplicationBuilder;import org.springframework.boot.context.embedded.ConfigurableEmbeddedServletContainer;import org.springframework.boot.context.embedded.EmbeddedServletContainerCustomizer;import org.springframework.boot.context.embedded.EmbeddedServletContainerFactory;import org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainerFactory;import org.springframework.boot.web.support.SpringBootServletInitializer;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.ImportResource;import org.springframework.scheduling.annotation.EnableScheduling;import org.springframework.transaction.annotation.EnableTransactionManagement;/** * 需要告知扫描的包名 * 启动事物扫描 */@ImportResource(locations={"classpath:mybatis/datasource-config.xml"})@SpringBootApplication(        scanBasePackages = {"sql", "integration.service",                "com.connor.hozon","cn.net.connor.hozon.*"})@EnableTransactionManagement@EnableScheduling//@MapperScan({"cn.net.connor.hozon.dao.**"})//在MybatisConfig配置类里面加public class HzBomSysApplication extends SpringBootServletInitializer {    @Override    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {        return application.sources(HzBomSysApplication.class);    }    public static void main(String[] args) {        SpringApplication.run(HzBomSysApplication.class, args);    }    @Bean    public EmbeddedServletContainerCustomizer containerCustomizer() {        return new EmbeddedServletContainerCustomizer() {            @Override            public void customize(ConfigurableEmbeddedServletContainer container) {                container.setSessionTimeout(7200);// 单位为S            }        };    }    /**     * it's for set http url auto change to https     */    @Bean    public EmbeddedServletContainerFactory servletContainer(){        TomcatEmbeddedServletContainerFactory tomcat=new TomcatEmbeddedServletContainerFactory(){            @Override            protected void postProcessContext(Context context) {                SecurityConstraint securityConstraint=new SecurityConstraint();                securityConstraint.setUserConstraint("CONFIDENTIAL");//confidential                SecurityCollection collection=new SecurityCollection();                collection.addPattern("/*");                securityConstraint.addCollection(collection);                context.addConstraint(securityConstraint);            }        };        tomcat.addAdditionalTomcatConnectors(httpConnector());        return tomcat;    }    @Bean    public Connector httpConnector(){        Connector connector=new Connector("org.apache.coyote.http11.Http11NioProtocol");        connector.setScheme("http");        connector.setPort(8080);        connector.setSecure(false);        connector.setRedirectPort(8443);//重定向到8443        return connector;    }}